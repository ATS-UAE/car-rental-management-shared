{"version":3,"sources":["components/containers/layout/Can.js","components/pages/FormPage.tsx","components/presentational/display/ListView.tsx","components/presentational/forms/AccidentForm.js","components/containers/forms/accidents/AccidentForm.js","components/containers/forms/accidents/AccidentFormCreate.js","components/containers/forms/accidents/AccidentFormCreateButtonDialog.js","components/containers/display/AccidentListView.js","components/pages/Accidents.tsx"],"names":["Can","auth","role","action","resource","params","yes","no","whatever","loading","fetchCurrentUserDetails","useState","access","setAccess","useEffect","$role","data","RBAC","can","then","excludedFields","getExcludedFields","components","undefined","child","push","cloneElement","key","propTypes","PropTypes","string","isRequired","object","func","node","defaultProps","connect","actions","FormPage","render","history","dialogProps","location","path","exitPath","onMount","classes","check","popUp","onChange","props","DialogComponent","childProps","PaperProps","className","paper","pathname","open","onClose","compose","withStyles","theme","padding","spacing","withRouter","createStyles","root","display","overflowY","height","drawer","width","flexShrink","drawerPaper","toggleButton","marginRight","body","content","flexDirection","flexGrow","transition","transitions","create","easing","sharp","duration","leavingScreen","marginLeft","contentShift","easeOut","enteringScreen","slide","position","withTheme","list","header","setOpen","Paper","Drawer","SlideProps","variant","anchor","classNames","AppBar","Toolbar","IconButton","onClick","ChevronLeft","ChevronRight","TEXT","FIELDS","SELECT","IMAGE","AccidentForm","title","exclude","errorNotes","onChangeEvent","values","userList","vehicleList","bookingList","footer","onError","errors","readOnly","hints","fields","type","name","id","persistEvent","validators","requiredField","label","required","fullWidth","items","Validator","v","length","GridProps","xs","sm","multiline","rowsMax","inputProps","maxLength","Form","users","vehicles","bookings","onSubmit","showFooter","setErrors","disableButton","setDisabledButton","validForm","currentTime","moment","value","$userList","map","firstName","lastName","username","$bookingList","$vehicleList","userId","reduce","acc","brand","model","plateNumber","find","booking","approved","finished","vehicleId","from","unix","to","Grid","item","Button","disabled","color","e","preventDefault","reduxActions","fetchAccidents","setErrorNotes","setLoading","setValues","event","target","files","api","createAccident","catch","apiErrorHandler","message","slice","state","createAccess","Action","CREATE","Resource","ACCIDENTS","button","actionButton","mixins","toolbar","borderRadius","accidentImageSrc","maxWidth","margin","accidents","accidentData","vehicleData","authData","formData","setFormData","accidentList","accident","READ","accessor","readAccess","vehicle","ListItem","selected","a","async","fetchAccident","accidentRes","fetchUser","userRes","updateAccident","read","user","console","error","Avatar","src","Image","ListItemText","primary","secondary","listHeader","container","justify","Role","roles","permission","REPORT_ACCIDENTS","aria-label","deleteButton","deleted","Delete","test","createdAt","alt","Typography","component","format","split","p","i","fetchBookings","fetchVehicles"],"mappings":"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","file":"static/js/12.633fb391.chunk.js","sourcesContent":["import { useEffect, useState, cloneElement } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport { connect } from \"react-redux\";\r\nimport * as actions from \"../../../actions\";\r\nimport RBAC from \"../../../utils/rbac\";\r\n\r\nfunction Can({\r\n\tauth,\r\n\trole,\r\n\taction,\r\n\tresource,\r\n\tparams,\r\n\tyes,\r\n\tno,\r\n\twhatever,\r\n\tloading,\r\n\tfetchCurrentUserDetails\r\n}) {\r\n\tlet [access, setAccess] = useState(null);\r\n\tuseEffect(() => {\r\n\t\tif (auth === null) {\r\n\t\t\tfetchCurrentUserDetails();\r\n\t\t}\r\n\t}, []);\r\n\tuseEffect(() => {\r\n\t\tif (auth) {\r\n\t\t\tlet $role = role || auth.data.role;\r\n\t\t\tRBAC.can($role, action, resource, params).then(access =>\r\n\t\t\t\tsetAccess({\r\n\t\t\t\t\taccess,\r\n\t\t\t\t\texcludedFields: RBAC.getExcludedFields($role, action, resource),\r\n\t\t\t\t\tparams,\r\n\t\t\t\t\tresource,\r\n\t\t\t\t\taction,\r\n\t\t\t\t\trole: $role,\r\n\t\t\t\t\tauth\r\n\t\t\t\t})\r\n\t\t\t);\r\n\t\t}\r\n\t}, [auth, role, action, resource, params]);\r\n\tif (access !== null) {\r\n\t\tlet components = [];\r\n\t\tif (whatever !== undefined) {\r\n\t\t\tlet child = whatever(access);\r\n\t\t\tif (child) components.push(cloneElement(child, { key: \"whatever\" }));\r\n\t\t}\r\n\t\tif (access.access && yes !== undefined) {\r\n\t\t\tlet child = yes(access);\r\n\t\t\tif (child) components.push(cloneElement(child, { key: \"yes\" }));\r\n\t\t} else if (no !== undefined) {\r\n\t\t\tlet child = no(access);\r\n\t\t\tif (child) components.push(cloneElement(child, { key: \"no\" }));\r\n\t\t}\r\n\t\treturn components;\r\n\t}\r\n\treturn loading || null;\r\n}\r\n\r\nCan.propTypes = {\r\n\trole: PropTypes.string,\r\n\taction: PropTypes.string.isRequired,\r\n\tresource: PropTypes.string.isRequired,\r\n\tparams: PropTypes.object,\r\n\tyes: PropTypes.func,\r\n\tno: PropTypes.func,\r\n\twhatever: PropTypes.func,\r\n\tloading: PropTypes.node\r\n};\r\n\r\nCan.defaultProps = {\r\n\tparams: {}\r\n};\r\n\r\nconst mapStateToProps = ({ auth }) => ({ auth });\r\n\r\nexport default connect(mapStateToProps, actions)(Can);\r\n","import React, { useEffect, FC } from \"react\";\r\nimport { Route } from \"react-router-dom\";\r\nimport { withRouter } from \"react-router\";\r\nimport { Dialog } from \"@material-ui/core\";\r\nimport { withStyles } from \"@material-ui/core/styles\";\r\nimport { compose } from \"recompose\";\r\n\r\nconst FormPage: FC<any> = ({\r\n\trender,\r\n\thistory,\r\n\tdialogProps,\r\n\tlocation,\r\n\tpath,\r\n\texitPath,\r\n\tonMount,\r\n\tclasses,\r\n\tcheck,\r\n\tpopUp,\r\n\tonChange\r\n}) => {\r\n\tif (check === undefined || check({ path, location }) === true)\r\n\t\treturn (\r\n\t\t\t<Route\r\n\t\t\t\tpath={path}\r\n\t\t\t\trender={props => (\r\n\t\t\t\t\t<DialogComponent\r\n\t\t\t\t\t\trender={render}\r\n\t\t\t\t\t\thistory={history}\r\n\t\t\t\t\t\texitPath={exitPath}\r\n\t\t\t\t\t\tchildProps={props}\r\n\t\t\t\t\t\tonMount={onMount}\r\n\t\t\t\t\t\tdialogProps={{\r\n\t\t\t\t\t\t\tPaperProps: {\r\n\t\t\t\t\t\t\t\tclassName: classes.paper\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t...dialogProps\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tpopUp={popUp}\r\n\t\t\t\t\t\tonChange={onChange}\r\n\t\t\t\t\t/>\r\n\t\t\t\t)}\r\n\t\t\t/>\r\n\t\t);\r\n\telse return null;\r\n};\r\n\r\nfunction DialogComponent({\r\n\trender,\r\n\tchildProps,\r\n\texitPath,\r\n\tdialogProps,\r\n\thistory,\r\n\tonMount,\r\n\tpopUp,\r\n\tonChange\r\n}) {\r\n\tuseEffect(() => {\r\n\t\tonMount && onMount(childProps);\r\n\t}, []);\r\n\tuseEffect(() => {\r\n\t\tonChange && onChange(childProps);\r\n\t}, [history.location.pathname]);\r\n\treturn popUp ? (\r\n\t\t<Dialog\r\n\t\t\topen={true}\r\n\t\t\tonClose={() => exitPath && history.push(exitPath)}\r\n\t\t\t{...dialogProps}\r\n\t\t>\r\n\t\t\t{render ? render(childProps) : null}\r\n\t\t</Dialog>\r\n\t) : render ? (\r\n\t\trender(childProps)\r\n\t) : null;\r\n}\r\n\r\nFormPage.defaultProps = {\r\n\tpopUp: true\r\n};\r\n\r\nconst styles = theme => ({\r\n\tpaper: {\r\n\t\tpadding: theme.spacing(3)\r\n\t}\r\n});\r\n\r\nexport default compose(\r\n\twithStyles(styles),\r\n\twithRouter\r\n)(FormPage);\r\n","import React, { useState, FC, ReactNode } from \"react\";\r\nimport { Paper, Theme } from \"@material-ui/core\";\r\nimport {\r\n\twithStyles,\r\n\tDrawer,\r\n\tIconButton,\r\n\tAppBar,\r\n\tToolbar,\r\n\tWithStyles,\r\n\tcreateStyles\r\n} from \"@material-ui/core\";\r\nimport { ChevronRight, ChevronLeft } from \"@material-ui/icons\";\r\nimport classNames from \"classnames\";\r\n\r\ninterface ListViewProps extends WithStyles<typeof styles> {\r\n\tlist: ReactNode;\r\n\tbody: ReactNode;\r\n\theader: ReactNode;\r\n}\r\n\r\nconst ListView: FC<ListViewProps> = ({ classes, list, body, header }) => {\r\n\tconst [open, setOpen] = useState(true);\r\n\treturn (\r\n\t\t<Paper className={classes.root}>\r\n\t\t\t<Drawer\r\n\t\t\t\tclassName={classes.drawer}\r\n\t\t\t\tSlideProps={{\r\n\t\t\t\t\t// @ts-ignore\r\n\t\t\t\t\tclassName: classes.slide\r\n\t\t\t\t}}\r\n\t\t\t\tvariant=\"persistent\"\r\n\t\t\t\tanchor=\"left\"\r\n\t\t\t\topen={open}\r\n\t\t\t\tclasses={{\r\n\t\t\t\t\tpaper: classes.drawerPaper\r\n\t\t\t\t}}\r\n\t\t\t>\r\n\t\t\t\t{list}\r\n\t\t\t</Drawer>\r\n\t\t\t<div\r\n\t\t\t\tclassName={classNames(classes.content, {\r\n\t\t\t\t\t[classes.contentShift]: open\r\n\t\t\t\t})}\r\n\t\t\t>\r\n\t\t\t\t<AppBar position=\"static\">\r\n\t\t\t\t\t<Toolbar>\r\n\t\t\t\t\t\t<IconButton\r\n\t\t\t\t\t\t\tclassName={classes.toggleButton}\r\n\t\t\t\t\t\t\tonClick={() => setOpen(!open)}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{open ? <ChevronLeft /> : <ChevronRight />}\r\n\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t{header}\r\n\t\t\t\t\t</Toolbar>\r\n\t\t\t\t</AppBar>\r\n\t\t\t\t<main className={classes.body}>{body}</main>\r\n\t\t\t</div>\r\n\t\t</Paper>\r\n\t);\r\n};\r\n\r\nconst drawerWidth = 240;\r\n\r\nconst styles = (theme: Theme) =>\r\n\tcreateStyles({\r\n\t\troot: {\r\n\t\t\tdisplay: \"flex\",\r\n\t\t\toverflowY: \"auto\",\r\n\t\t\theight: \"100%\"\r\n\t\t},\r\n\t\tdrawer: {\r\n\t\t\twidth: drawerWidth,\r\n\t\t\tflexShrink: 0\r\n\t\t},\r\n\t\tdrawerPaper: {\r\n\t\t\twidth: drawerWidth\r\n\t\t},\r\n\t\ttoggleButton: {\r\n\t\t\tmarginRight: theme.spacing(3)\r\n\t\t},\r\n\t\tbody: {\r\n\t\t\tpadding: theme.spacing(3),\r\n\t\t\toverflowY: \"auto\"\r\n\t\t},\r\n\t\tcontent: {\r\n\t\t\tdisplay: \"flex\",\r\n\t\t\tflexDirection: \"column\",\r\n\t\t\tflexGrow: 1,\r\n\t\t\ttransition: theme.transitions.create(\"margin\", {\r\n\t\t\t\teasing: theme.transitions.easing.sharp,\r\n\t\t\t\tduration: theme.transitions.duration.leavingScreen\r\n\t\t\t}),\r\n\t\t\tmarginLeft: -drawerWidth\r\n\t\t},\r\n\t\tcontentShift: {\r\n\t\t\ttransition: theme.transitions.create(\"margin\", {\r\n\t\t\t\teasing: theme.transitions.easing.easeOut,\r\n\t\t\t\tduration: theme.transitions.duration.enteringScreen\r\n\t\t\t}),\r\n\t\t\tmarginLeft: 0\r\n\t\t},\r\n\t\tslide: {\r\n\t\t\theight: \"100%\",\r\n\t\t\toverflowY: \"auto\",\r\n\t\t\tposition: \"static\"\r\n\t\t}\r\n\t});\r\n\r\nexport default withStyles(styles, { withTheme: true })(ListView);\r\n","import React from \"react\";\r\nimport { validators, Validator } from \"../../../utils/helpers\";\r\nimport Form, { FIELDS } from \"./Form\";\r\nconst { TEXT, SELECT, IMAGE } = FIELDS;\r\n\r\nfunction AccidentForm({\r\n\ttitle,\r\n\texclude,\r\n\terrorNotes,\r\n\tonChangeEvent,\r\n\tvalues,\r\n\tuserList,\r\n\tvehicleList,\r\n\tbookingList,\r\n\tfooter,\r\n\tonError,\r\n\terrors,\r\n\treadOnly,\r\n\thints\r\n}) {\r\n\tconst fields = [\r\n\t\t{\r\n\t\t\ttype: IMAGE,\r\n\t\t\tname: \"accidentImageSrc\",\r\n\t\t\tid: \"accident-image\",\r\n\t\t\tpersistEvent: true,\r\n\t\t\tvalidators: [validators.requiredField],\r\n\t\t\tprops: {\r\n\t\t\t\tlabel: \"Select picture\",\r\n\t\t\t\trequired: true\r\n\t\t\t}\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: SELECT,\r\n\t\t\tid: \"user-id\",\r\n\t\t\tname: \"userId\",\r\n\t\t\tprops: {\r\n\t\t\t\tlabel: \"User\",\r\n\t\t\t\tfullWidth: true,\r\n\t\t\t\titems: userList\r\n\t\t\t}\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: SELECT,\r\n\t\t\tid: \"vehicle-id\",\r\n\t\t\tname: \"vehicleId\",\r\n\t\t\tvalidators: [validators.requiredField],\r\n\t\t\tprops: {\r\n\t\t\t\tlabel: \"Vehicle\",\r\n\t\t\t\tfullWidth: true,\r\n\t\t\t\titems: vehicleList\r\n\t\t\t}\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: SELECT,\r\n\t\t\tid: \"booking-id\",\r\n\t\t\tname: \"bookingId\",\r\n\t\t\tprops: {\r\n\t\t\t\tlabel: \"Booking ID\",\r\n\t\t\t\tfullWidth: true,\r\n\t\t\t\titems: bookingList\r\n\t\t\t}\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: TEXT,\r\n\t\t\tid: \"message\",\r\n\t\t\tname: \"message\",\r\n\t\t\tvalidators: [\r\n\t\t\t\tvalidators.requiredField,\r\n\t\t\t\tnew Validator(v => v && v.length <= 500)\r\n\t\t\t],\r\n\t\t\tGridProps: {\r\n\t\t\t\txs: 12,\r\n\t\t\t\tsm: 12\r\n\t\t\t},\r\n\t\t\tprops: {\r\n\t\t\t\tmultiline: true,\r\n\t\t\t\tvariant: \"filled\",\r\n\t\t\t\tfullWidth: true,\r\n\t\t\t\trowsMax: 6,\r\n\t\t\t\tlabel: \"Message\",\r\n\t\t\t\trequired: true,\r\n\t\t\t\tinputProps: {\r\n\t\t\t\t\tmaxLength: 500\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t];\r\n\r\n\treturn (\r\n\t\t<Form\r\n\t\t\ttitle={title}\r\n\t\t\tfields={fields}\r\n\t\t\texclude={exclude}\r\n\t\t\terrorNotes={errorNotes}\r\n\t\t\tonChangeEvent={onChangeEvent}\r\n\t\t\tvalues={values}\r\n\t\t\tfooter={footer}\r\n\t\t\terrors={errors}\r\n\t\t\tonError={onError}\r\n\t\t\thints={hints}\r\n\t\t\treadOnly={readOnly}\r\n\t\t/>\r\n\t);\r\n}\r\n\r\nexport default AccidentForm;\r\n","import React, { useState, useEffect, Fragment } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport moment from \"moment\";\r\nimport { Grid, Button } from \"@material-ui/core\";\r\nimport AccidentForm from \"../../../presentational/forms/AccidentForm\";\r\n\r\nfunction AccidentFormContainer({\r\n\tonSubmit,\r\n\tvalues,\r\n\treadOnly,\r\n\texclude,\r\n\ttitle,\r\n\tloading,\r\n\thints,\r\n\tonChangeEvent,\r\n\terrorNotes,\r\n\tusers,\r\n\tvehicles,\r\n\tbookings,\r\n\tshowFooter\r\n}) {\r\n\tlet [errors, setErrors] = useState({});\r\n\tlet [disableButton, setDisabledButton] = useState(false);\r\n\r\n\tuseEffect(() => {\r\n\t\tlet validForm = true;\r\n\t\tfor (let key in errors) {\r\n\t\t\tif (errors[key].length) {\r\n\t\t\t\tvalidForm = false;\r\n\t\t\t}\r\n\t\t}\r\n\t\tsetDisabledButton(!validForm);\r\n\t}, [errors, values]);\r\n\r\n\tlet currentTime = moment();\r\n\r\n\tlet userList = [{ value: \"\", label: \"Loading...\" }];\r\n\tlet bookingList = [{ value: \"\", label: \"Loading...\" }];\r\n\tlet vehicleList = [{ value: \"\", label: \"Loading...\" }];\r\n\r\n\tif (bookings && vehicles) {\r\n\t\tlet $userList = users\r\n\t\t\t? users.map(({ id, firstName, lastName, username }) => ({\r\n\t\t\t\t\tvalue: id,\r\n\t\t\t\t\tlabel: `${firstName} ${lastName} - ${username}`\r\n\t\t\t  }))\r\n\t\t\t: [];\r\n\t\tuserList = $userList.length\r\n\t\t\t? $userList\r\n\t\t\t: [{ value: \"\", label: \"No users found...\" }];\r\n\r\n\t\tlet $bookingList = bookings.map(({ id }) => ({\r\n\t\t\tvalue: id,\r\n\t\t\tlabel: id\r\n\t\t}));\r\n\t\tbookingList = $bookingList.length\r\n\t\t\t? $bookingList\r\n\t\t\t: [{ value: \"\", label: \"No bookings found...\" }];\r\n\r\n\t\tlet $vehicleList = values.userId\r\n\t\t\t? vehicles.reduce((acc, { id, brand, model, plateNumber }) => {\r\n\t\t\t\t\tlet activeVehicle = bookings.find(\r\n\t\t\t\t\t\tbooking =>\r\n\t\t\t\t\t\t\tbooking.approved === true &&\r\n\t\t\t\t\t\t\tbooking.finished === false &&\r\n\t\t\t\t\t\t\tbooking.vehicleId === id &&\r\n\t\t\t\t\t\t\tbooking.from <= currentTime.unix() &&\r\n\t\t\t\t\t\t\tbooking.to >= currentTime.unix()\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\tif (activeVehicle)\r\n\t\t\t\t\t\tacc.push({\r\n\t\t\t\t\t\t\tvalue: id,\r\n\t\t\t\t\t\t\tlabel: `${brand} ${model} - ${plateNumber}`\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\treturn acc;\r\n\t\t\t  }, [])\r\n\t\t\t: [{ value: \"\", label: \"Please select a user...\" }];\r\n\t\tvehicleList = $vehicleList.length\r\n\t\t\t? $vehicleList\r\n\t\t\t: [{ value: \"\", label: \"No vehicles found...\" }];\r\n\t}\r\n\r\n\tlet footer = showFooter && (\r\n\t\t<Fragment>\r\n\t\t\t<Grid item>\r\n\t\t\t\t<Button\r\n\t\t\t\t\tdisabled={loading || disableButton}\r\n\t\t\t\t\ttype=\"submit\"\r\n\t\t\t\t\tvariant=\"contained\"\r\n\t\t\t\t\tcolor=\"primary\"\r\n\t\t\t\t\tonClick={e => {\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\tonSubmit(e);\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\tConfirm\r\n\t\t\t\t</Button>\r\n\t\t\t</Grid>\r\n\t\t</Fragment>\r\n\t);\r\n\treturn (\r\n\t\t<AccidentForm\r\n\t\t\tuserList={userList}\r\n\t\t\tbookingList={bookingList}\r\n\t\t\tvehicleList={vehicleList}\r\n\t\t\texclude={exclude}\r\n\t\t\ttitle={title}\r\n\t\t\tvalues={values}\r\n\t\t\tonChangeEvent={onChangeEvent}\r\n\t\t\terrorNotes={errorNotes}\r\n\t\t\tfooter={footer}\r\n\t\t\tonError={setErrors}\r\n\t\t\terrors={errors}\r\n\t\t\thints={hints}\r\n\t\t\treadOnly={readOnly}\r\n\t\t/>\r\n\t);\r\n}\r\n\r\nconst mapStateToProps = ({ users, vehicles, bookings }) => {\r\n\tlet userList = null;\r\n\tlet vehicleList = null;\r\n\tlet bookingList = null;\r\n\r\n\tif (users && users.data) userList = users.data;\r\n\tif (vehicles && vehicles.data) vehicleList = vehicles.data;\r\n\tif (bookings && bookings.data) bookingList = bookings.data;\r\n\r\n\treturn { users: userList, vehicles: vehicleList, bookings: bookingList };\r\n};\r\n\r\nexport default connect(mapStateToProps)(AccidentFormContainer);\r\n","import React, { useState, useEffect } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport AccidentForm from \"./AccidentForm\";\r\nimport * as reduxActions from \"../../../../actions\";\r\nimport { api, apiErrorHandler } from \"../../../../utils/helpers\";\r\n\r\nfunction AccidentFormCreate({ fetchAccidents, exclude, onSubmit, auth }) {\r\n\tconst [errorNotes, setErrorNotes] = useState([]);\r\n\tconst [loading, setLoading] = useState(false);\r\n\tconst [values, setValues] = useState({});\r\n\r\n\tuseEffect(() => {\r\n\t\tif (auth && auth.data) {\r\n\t\t\tsetValues({ ...values, userId: auth.data.id });\r\n\t\t}\r\n\t}, [auth]);\r\n\r\n\treturn (\r\n\t\t<AccidentForm\r\n\t\t\ttitle=\"Report an accident\"\r\n\t\t\tvalues={values}\r\n\t\t\tonChangeEvent={(data, name, event) =>\r\n\t\t\t\tevent.target.files\r\n\t\t\t\t\t? setValues({ ...data, [name]: event.target.files[0] || \"\" })\r\n\t\t\t\t\t: setValues(data)\r\n\t\t\t}\r\n\t\t\terrorNotes={errorNotes}\r\n\t\t\texclude={exclude}\r\n\t\t\tloading={loading}\r\n\t\t\tshowFooter={true}\r\n\t\t\tonSubmit={() => {\r\n\t\t\t\tsetLoading(true);\r\n\t\t\t\tapi\r\n\t\t\t\t\t.createAccident(values)\r\n\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\tfetchAccidents();\r\n\t\t\t\t\t\tsetValues({});\r\n\t\t\t\t\t\tsetLoading(false);\r\n\t\t\t\t\t\tonSubmit && onSubmit();\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch(e => {\r\n\t\t\t\t\t\tsetErrorNotes([apiErrorHandler(e).message]);\r\n\t\t\t\t\t\tsetLoading(false);\r\n\t\t\t\t\t});\r\n\t\t\t}}\r\n\t\t/>\r\n\t);\r\n}\r\n\r\nconst mapStateToProps = ({ auth }) => ({ auth });\r\n\r\nexport default connect(\r\n\tmapStateToProps,\r\n\treduxActions\r\n)(AccidentFormCreate);\r\n","import React, { Fragment } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { compose } from \"recompose\";\r\nimport { withRouter } from \"react-router\";\r\nimport { Button } from \"@material-ui/core\";\r\nimport AccidentFormCreate from \"./AccidentFormCreate\";\r\nimport FormPage from \"../../../pages/FormPage\";\r\nimport Can from \"../../layout/Can\";\r\nimport { Resource, Action } from \"../../../../variables/enums\";\r\n\r\nfunction AccidentFormCreateButtonDialog({ history, classes }) {\r\n\treturn (\r\n\t\t<Fragment>\r\n\t\t\t<FormPage\r\n\t\t\t\tpath=\"/accidents/new\"\r\n\t\t\t\tcheck={({ path }) => path.slice(-3) === \"new\"}\r\n\t\t\t\texitPath=\"/accidents\"\r\n\t\t\t\trender={({ location }) => {\r\n\t\t\t\t\tlet exclude = [];\r\n\t\t\t\t\tif (\r\n\t\t\t\t\t\tlocation.state &&\r\n\t\t\t\t\t\tlocation.state.createAccess &&\r\n\t\t\t\t\t\tlocation.state.createAccess.excludedFields\r\n\t\t\t\t\t) {\r\n\t\t\t\t\t\texclude = location.state.createAccess.excludedFields;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t<AccidentFormCreate\r\n\t\t\t\t\t\t\texclude={exclude}\r\n\t\t\t\t\t\t\tonSubmit={() => history.push(\"/accidents\")}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t);\r\n\t\t\t\t}}\r\n\t\t\t/>\r\n\t\t\t<Can\r\n\t\t\t\taction={Action.CREATE}\r\n\t\t\t\tresource={Resource.ACCIDENTS}\r\n\t\t\t\tyes={createAccess => (\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\tclassName={classes.button}\r\n\t\t\t\t\t\ttype=\"submit\"\r\n\t\t\t\t\t\tvariant=\"contained\"\r\n\t\t\t\t\t\tcolor=\"primary\"\r\n\t\t\t\t\t\tonClick={() => history.push(\"/accidents/new\", { createAccess })}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tReport an accident\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t)}\r\n\t\t\t/>\r\n\t\t</Fragment>\r\n\t);\r\n}\r\n\r\nconst mapStateToProps = ({ bookings, auth, vehicles }) => ({\r\n\tbookings,\r\n\tauth,\r\n\tvehicles\r\n});\r\n\r\nexport default compose(\r\n\twithRouter,\r\n\tconnect(mapStateToProps)\r\n)(AccidentFormCreateButtonDialog);\r\n","import React, { useState, Fragment } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { withRouter } from \"react-router\";\r\nimport { compose } from \"recompose\";\r\nimport {\r\n\tListItem,\r\n\tAvatar,\r\n\tListItemText,\r\n\tGrid,\r\n\twithStyles,\r\n\tTypography,\r\n\tIconButton\r\n} from \"@material-ui/core\";\r\nimport { Delete, Image } from \"@material-ui/icons\";\r\nimport moment from \"moment\";\r\n\r\nimport * as reduxActions from \"../../../actions\";\r\nimport { Action, Resource } from \"../../../variables/enums\";\r\nimport { Role, permission } from \"../layout/Role\";\r\nimport Can from \"../layout/Can\";\r\nimport api from \"../../../utils/helpers/api\";\r\nimport ListView from \"../../presentational/display/ListView\";\r\nimport AccidentFormCreateButtonDialog from \"../forms/accidents/AccidentFormCreateButtonDialog\";\r\nimport FormPage from \"../../pages/FormPage\";\r\n\r\nconst mapStateToProps = ({ accidents, vehicles, auth }) => {\r\n\tlet accidentData = null;\r\n\tlet vehicleData = null;\r\n\tlet authData = {};\r\n\tif (accidents && accidents.data) accidentData = accidents.data;\r\n\r\n\tif (vehicles && vehicles.data) vehicleData = vehicles.data;\r\n\r\n\tif (auth && auth.data) authData = auth.data;\r\n\r\n\treturn { accidents: accidentData, vehicles: vehicleData, auth: authData };\r\n};\r\n\r\nconst styles = theme => ({\r\n\tactionButton: {\r\n\t\t...theme.mixins.toolbar,\r\n\t\tborderRadius: 0,\r\n\t\twidth: \"100%\"\r\n\t},\r\n\taccidentImageSrc: {\r\n\t\tmaxWidth: \"500px\",\r\n\t\twidth: \"50%\",\r\n\t\tdisplay: \"block\",\r\n\t\tmargin: \"0 auto\"\r\n\t}\r\n});\r\n\r\nconst AccidentListView = ({\r\n\taccidents,\r\n\tvehicles,\r\n\thistory,\r\n\tclasses,\r\n\tauth,\r\n\tfetchAccidents\r\n}) => {\r\n\tconst [formData, setFormData] = useState({});\r\n\r\n\tlet accidentList = [];\r\n\tif (accidents && vehicles) {\r\n\t\taccidentList =\r\n\t\t\taccidents.length > 0 ? (\r\n\t\t\t\taccidents.map(accident => (\r\n\t\t\t\t\t<Can\r\n\t\t\t\t\t\tkey={accident.id}\r\n\t\t\t\t\t\taction={Action.READ}\r\n\t\t\t\t\t\tresource={Resource.ACCIDENTS}\r\n\t\t\t\t\t\tparams={{ accessor: auth, target: accident }}\r\n\t\t\t\t\t\tyes={readAccess => {\r\n\t\t\t\t\t\t\tlet vehicle = vehicles.find(\r\n\t\t\t\t\t\t\t\tvehicle => vehicle.id === accident.vehicleId\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t<ListItem\r\n\t\t\t\t\t\t\t\t\tselected={\r\n\t\t\t\t\t\t\t\t\t\tformData &&\r\n\t\t\t\t\t\t\t\t\t\tformData.accident &&\r\n\t\t\t\t\t\t\t\t\t\tformData.accident.id === accident.id\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tbutton\r\n\t\t\t\t\t\t\t\t\tonClick={async () => {\r\n\t\t\t\t\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\t\t\t\t\tlet accidentRes = await api.fetchAccident(accident.id);\r\n\t\t\t\t\t\t\t\t\t\t\tlet userRes = await api.fetchUser(accident.userId);\r\n\t\t\t\t\t\t\t\t\t\t\tawait api.updateAccident({\r\n\t\t\t\t\t\t\t\t\t\t\t\tid: accident.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tread: true\r\n\t\t\t\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t\t\t\t\thistory.push(`/accidents/${accident.id}`, {\r\n\t\t\t\t\t\t\t\t\t\t\t\taccident: accidentRes.data,\r\n\t\t\t\t\t\t\t\t\t\t\t\tuser: userRes.data,\r\n\t\t\t\t\t\t\t\t\t\t\t\treadAccess\r\n\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\t\t\t\t\t\tconsole.error(e);\r\n\t\t\t\t\t\t\t\t\t\t\thistory.push(\"/accidents\");\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<Avatar src={accident.accidentImageSrc || undefined}>\r\n\t\t\t\t\t\t\t\t\t\t{!accident.accidentImageSrc && <Image />}\r\n\t\t\t\t\t\t\t\t\t</Avatar>\r\n\t\t\t\t\t\t\t\t\t<ListItemText\r\n\t\t\t\t\t\t\t\t\t\tprimary={`${vehicle.brand} ${vehicle.model}`}\r\n\t\t\t\t\t\t\t\t\t\tsecondary={vehicle.plateNumber}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t</ListItem>\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t/>\r\n\t\t\t\t))\r\n\t\t\t) : (\r\n\t\t\t\t<ListItem>\r\n\t\t\t\t\t<ListItemText primary=\"There seems to be nothing here\" />\r\n\t\t\t\t</ListItem>\r\n\t\t\t);\r\n\t}\r\n\r\n\tconst listHeader = (\r\n\t\t<Grid container justify=\"space-between\">\r\n\t\t\t<Role roles={permission.REPORT_ACCIDENTS}>\r\n\t\t\t\t<AccidentFormCreateButtonDialog\r\n\t\t\t\t\tclasses={{ button: classes.actionButton }}\r\n\t\t\t\t/>\r\n\t\t\t</Role>\r\n\t\t</Grid>\r\n\t);\r\n\r\n\treturn (\r\n\t\t<ListView\r\n\t\t\tlist={\r\n\t\t\t\t<Fragment>\r\n\t\t\t\t\t{listHeader}\r\n\t\t\t\t\t{accidentList}\r\n\t\t\t\t</Fragment>\r\n\t\t\t}\r\n\t\t\theader={\r\n\t\t\t\tformData && formData.accident ? (\r\n\t\t\t\t\t<IconButton\r\n\t\t\t\t\t\taria-label=\"Delete\"\r\n\t\t\t\t\t\tclassName={classes.deleteButton}\r\n\t\t\t\t\t\tonClick={() =>\r\n\t\t\t\t\t\t\tapi\r\n\t\t\t\t\t\t\t\t.updateAccident({ id: formData.accident.id, deleted: true })\r\n\t\t\t\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\t\t\t\tfetchAccidents();\r\n\t\t\t\t\t\t\t\t\tsetFormData({});\r\n\t\t\t\t\t\t\t\t\thistory.push(\"/accidents\");\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Delete />\r\n\t\t\t\t\t</IconButton>\r\n\t\t\t\t) : null\r\n\t\t\t}\r\n\t\t\tbody={\r\n\t\t\t\t<FormPage\r\n\t\t\t\t\tpath=\"/accidents/:id\"\r\n\t\t\t\t\tcheck={({ location }) => /\\/accidents\\/\\d+/.test(location.pathname)}\r\n\t\t\t\t\trender={() => {\r\n\t\t\t\t\t\tif (formData && formData.accident && formData.user) {\r\n\t\t\t\t\t\t\tconst accident = formData.accident;\r\n\t\t\t\t\t\t\tconst user = formData.user;\r\n\t\t\t\t\t\t\tconst { accidentImageSrc, message, createdAt } = accident;\r\n\t\t\t\t\t\t\tconst { firstName, lastName } = user;\r\n\r\n\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t<Grid container spacing={2}>\r\n\t\t\t\t\t\t\t\t\t{accidentImageSrc && (\r\n\t\t\t\t\t\t\t\t\t\t<Grid item xs={12}>\r\n\t\t\t\t\t\t\t\t\t\t\t<img\r\n\t\t\t\t\t\t\t\t\t\t\t\tsrc={accidentImageSrc}\r\n\t\t\t\t\t\t\t\t\t\t\t\talt=\"Accident\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tclassName={classes.accidentImageSrc}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t</Grid>\r\n\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t<Grid item xs={12}>\r\n\t\t\t\t\t\t\t\t\t\t<Typography>\r\n\t\t\t\t\t\t\t\t\t\t\t<Typography\r\n\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"h6\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tcomponent=\"span\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tdisplay=\"inline\"\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\tFrom:\r\n\t\t\t\t\t\t\t\t\t\t\t</Typography>\r\n\t\t\t\t\t\t\t\t\t\t\t<Typography\r\n\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"subtitle1\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tcomponent=\"span\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tdisplay=\"inline\"\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{`${firstName} ${lastName}`}\r\n\t\t\t\t\t\t\t\t\t\t\t</Typography>\r\n\t\t\t\t\t\t\t\t\t\t</Typography>\r\n\t\t\t\t\t\t\t\t\t\t<Typography>\r\n\t\t\t\t\t\t\t\t\t\t\t<Typography\r\n\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"h6\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tcomponent=\"span\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tdisplay=\"inline\"\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\tDate:\r\n\t\t\t\t\t\t\t\t\t\t\t</Typography>\r\n\t\t\t\t\t\t\t\t\t\t\t<Typography\r\n\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"subtitle1\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tcomponent=\"span\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tdisplay=\"inline\"\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{moment(createdAt, \"X\").format(\"LLL\")}\r\n\t\t\t\t\t\t\t\t\t\t\t</Typography>\r\n\t\t\t\t\t\t\t\t\t\t</Typography>\r\n\t\t\t\t\t\t\t\t\t\t{message && (\r\n\t\t\t\t\t\t\t\t\t\t\t<Fragment>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Typography\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"h6\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcomponent=\"span\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tdisplay=\"inline\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tMessage:\r\n\t\t\t\t\t\t\t\t\t\t\t\t</Typography>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{message.split(\"\\n\").map((p, i) => (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Typography key={i} variant=\"body1\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{p}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</Typography>\r\n\t\t\t\t\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t\t\t\t\t</Fragment>\r\n\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t</Grid>\r\n\t\t\t\t\t\t\t\t</Grid>\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn null;\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tpopUp={false}\r\n\t\t\t\t\tonChange={({ location }) => {\r\n\t\t\t\t\t\tlocation &&\r\n\t\t\t\t\t\t\tlocation.state &&\r\n\t\t\t\t\t\t\tlocation.state.accident &&\r\n\t\t\t\t\t\t\tlocation.state.user &&\r\n\t\t\t\t\t\t\tsetFormData({\r\n\t\t\t\t\t\t\t\taccident: location.state.accident,\r\n\t\t\t\t\t\t\t\tuser: location.state.user\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t}}\r\n\t\t\t\t/>\r\n\t\t\t}\r\n\t\t/>\r\n\t);\r\n};\r\n\r\nexport default compose(\r\n\twithStyles(styles),\r\n\tconnect(\r\n\t\tmapStateToProps,\r\n\t\treduxActions\r\n\t),\r\n\twithRouter\r\n)(AccidentListView);\r\n","import React, { useEffect, FC } from \"react\";\r\nimport { connect } from \"react-redux\";\r\n\r\nimport * as actions from \"../../actions\";\r\nimport AccidentListView from \"../containers/display/AccidentListView\";\r\n\r\ntype Props = typeof actions;\r\n\r\nconst Accidents: FC<Props> = ({\r\n\tfetchAccidents,\r\n\tfetchBookings,\r\n\tfetchCurrentUserDetails,\r\n\tfetchVehicles\r\n}) => {\r\n\tuseEffect(() => {\r\n\t\tfetchAccidents();\r\n\t\tfetchBookings();\r\n\t\tfetchCurrentUserDetails();\r\n\t\tfetchVehicles();\r\n\t}, []);\r\n\treturn <AccidentListView />;\r\n};\r\n\r\nexport default connect<{}, {}, Props>(\r\n\tnull,\r\n\tactions\r\n)(Accidents);\r\n"],"sourceRoot":""}