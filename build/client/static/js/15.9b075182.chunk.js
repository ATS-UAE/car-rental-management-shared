(this.webpackJsonptemp=this.webpackJsonptemp||[]).push([[15],{922:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(75),i=n(180),o=n(22),l=n(21),s=n(33),u=n(32),d=n(34),f=n(112),p=n(181),h=n(61),m=(n(162),function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).previousLocation=n.props.location,n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentWillUpdate",value:function(e){var t=this.props.location;"POP"===e.history.action||t.state&&t.state.modal||(this.previousLocation=this.props.location)}},{key:"render",value:function(){var e=this.props,t=e.location,n=e.routes,a=!(!t.state||!t.state.modal||this.previousLocation===t);return n.map((function(e){var t=e.path,n=e.component,c=e.render;return a?r.a.createElement(f.b,{key:t,path:t,component:n,render:c}):null}))}}]),t}(a.Component));var b=n(292),g=n.n(b),O=n(884),j=n(844),v=n(883),E=n(846),y=n(847),C=n(137),k=function(e){var t,n=e.content,a=e.dialogProps,c=e.title,i=e.actions,o=e.open,l=e.onClose;return t="string"===typeof n?r.a.createElement(O.a,{id:"alert-dialog-description"},n):n,r.a.createElement(j.a,Object.assign({open:o,onClose:l},a),r.a.createElement(v.a,{id:"alert-dialog-title"},c),r.a.createElement(E.a,null,t),r.a.createElement(y.a,null,i&&i.map((function(e){var t=e.color,n=e.onClick,a=e.buttonProps,c=e.text;return r.a.createElement(C.a,Object.assign({onClick:n,color:t},a),c)}))))},S=n(41),w=n(48),R=n(6),I=n(879),L=n(3),P=n(4),N=(n(2),n(5)),x=n(72),A=r.a.forwardRef((function(e,t){var n=e.action,a=e.avatar,c=e.classes,i=e.className,o=e.component,l=void 0===o?"div":o,s=e.disableTypography,u=void 0!==s&&s,d=e.subheader,f=e.subheaderTypographyProps,p=e.title,h=e.titleTypographyProps,m=Object(P.a)(e,["action","avatar","classes","className","component","disableTypography","subheader","subheaderTypographyProps","title","titleTypographyProps"]),b=p;null==b||b.type===x.a||u||(b=r.a.createElement(x.a,Object(L.a)({variant:a?"body2":"h5",className:c.title,component:"span",display:"block"},h),b));var g=d;return null==g||g.type===x.a||u||(g=r.a.createElement(x.a,Object(L.a)({variant:a?"body2":"body1",className:c.subheader,color:"textSecondary",component:"span",display:"block"},f),g)),r.a.createElement(l,Object(L.a)({className:Object(N.a)(c.root,i),ref:t},m),a&&r.a.createElement("div",{className:c.avatar},a),r.a.createElement("div",{className:c.content},b,g),n&&r.a.createElement("div",{className:c.action},n))})),D=Object(R.a)({root:{display:"flex",alignItems:"center",padding:16},avatar:{flex:"0 0 auto",marginRight:16},action:{flex:"0 0 auto",alignSelf:"flex-start",marginTop:-8,marginRight:-8},content:{flex:"1 1 auto"},title:{},subheader:{}},{name:"MuiCardHeader"})(A),T=n(456),U=n(876),M=n(871),F=n(840),V=n(877),z=n(320),H=n(238),J=n(237),W=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).C=n.wrapperFunc(),n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(this.C,this.props)}},{key:"wrapperFunc",value:function(){return Object(R.a)(B)(q)}}]),t}(a.Component),q=function(e){function t(e){var n;Object(o.a)(this,t),(n=Object(s.a)(this,Object(u.a)(t).call(this,e))).leftChecked=[],n.rightChecked=[],n.componentDidUpdate=function(e){n.props.items!==e.items&&n.setState({left:n.not(n.props.items,n.props.right)})},n.not=function(e,t){return e.filter((function(e){return-1===t.findIndex((function(t){return n.props.comparator(e,t)}))}))},n.intersection=function(e,t){return e.filter((function(e){return-1!==t.findIndex((function(t){return n.props.comparator(e,t)}))}))},n.union=function(e,t){return[].concat(Object(w.a)(e),Object(w.a)(n.not(t,e)))},n.handleToggle=function(e){return function(){var t=n.state.checked,a=t.findIndex((function(t){return n.props.comparator(t,e)})),r=Object(w.a)(t);-1===a?r.push(e):r.splice(a,1),n.setState({checked:r})}},n.numberOfChecked=function(e){return n.intersection(n.state.checked,e).length},n.handleToggleAll=function(e){return function(){var t=n.state.checked;n.numberOfChecked(e)===e.length?n.setState({checked:n.not(t,e)}):n.setState({checked:n.union(t,e)})}},n.handleCheckedRight=function(){var e=n.state,t=e.left,a=e.checked,r=n.props,c=r.right,i=r.onChange;n.setState({left:n.not(t,n.leftChecked)}),i(c.concat(n.leftChecked)),n.setState({checked:n.not(a,n.leftChecked)})},n.handleCheckedLeft=function(){var e=n.state,t=e.left,a=e.checked,r=n.props,c=r.right;(0,r.onChange)(n.not(c,n.rightChecked)),n.setState({left:t.concat(n.rightChecked)}),n.setState({checked:n.not(a,n.rightChecked)})},n.customList=function(e,t){return r.a.createElement(I.a,null,r.a.createElement(D,{className:n.props.classes.cardHeader,avatar:r.a.createElement(T.a,{onClick:n.handleToggleAll(t),checked:n.numberOfChecked(t)===t.length&&0!==t.length,indeterminate:n.numberOfChecked(t)!==t.length&&0!==n.numberOfChecked(t),disabled:0===t.length,inputProps:{"aria-label":"all items selected"}}),title:e,subheader:"".concat(n.numberOfChecked(t),"/").concat(t.length," selected")}),r.a.createElement(U.a,null),r.a.createElement(M.a,{className:n.props.classes.list,dense:!0,component:"div",role:"list"},t.map((function(e){var t=n.props.listMapper(e);return r.a.createElement(F.a,{key:t.id,role:"listitem",button:!0,onClick:n.handleToggle(e)},r.a.createElement(V.a,null,r.a.createElement(T.a,{checked:-1!==n.state.checked.findIndex((function(t){return n.props.comparator(e,t)})),tabIndex:-1,disableRipple:!0,inputProps:{"aria-labelledby":String(t.id)}})),r.a.createElement(z.a,{id:String(t.id),primary:t.primaryLabel,secondary:t.secondaryLabel}))})),r.a.createElement(F.a,null)))};var a=e.items,c=e.right;return n.state={checked:[],left:n.not(a,c)},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.state,t=e.checked,n=e.left,a=this.props,c=a.classes,i=a.onSubmit,o=a.right;return this.leftChecked=this.intersection(t,n),this.rightChecked=this.intersection(t,o),r.a.createElement(H.a,{container:!0,spacing:2,justify:"center",alignItems:"center",className:c.root},r.a.createElement(H.a,{item:!0},this.customList("Choices",n)),r.a.createElement(H.a,{item:!0},r.a.createElement(H.a,{container:!0,direction:"column",alignItems:"center"},r.a.createElement(C.a,{variant:"outlined",size:"small",className:c.button,onClick:this.handleCheckedRight,disabled:0===this.leftChecked.length,"aria-label":"move selected right"},">"),r.a.createElement(C.a,{variant:"outlined",size:"small",className:c.button,onClick:this.handleCheckedLeft,disabled:0===this.rightChecked.length,"aria-label":"move selected left"},"<"))),r.a.createElement(H.a,{item:!0},this.customList("Chosen",o)),r.a.createElement(C.a,{color:"primary",variant:"contained",size:"large",disabled:this.props.loading,onClick:function(e){return i(e,o)}},"Done"))}}]),t}(a.Component),B=function(e){return Object(J.a)({root:{margin:"auto"},cardHeader:{padding:e.spacing(1,2)},list:{width:200,height:230,backgroundColor:e.palette.background.paper,overflow:"auto"},button:{margin:e.spacing(.5,0)}})},G=Object(c.b)((function(e){return{locations:e.locations}}),(function(){return i}))((function(e){var t=e.locations,n=e.clientId,c=e.fetchLocations,i=e.onSubmit,o=Object(a.useState)([]),l=Object(S.a)(o,2),s=l[0],u=l[1],d=Object(a.useState)([]),f=Object(S.a)(d,2),p=f[0],m=f[1],b=Object(a.useState)(!1),g=Object(S.a)(b,2),O=g[0],j=g[1];return Object(a.useEffect)((function(){if(t&&t.data){var e=[],a=[],r=!0,c=!1,i=void 0;try{for(var o,l=t.data[Symbol.iterator]();!(r=(o=l.next()).done);r=!0){var s=o.value;t.data&&t.data.find((function(e){return e.clients.find((function(e){return e.id===n}))}))?a.push(s):e.push(s)}}catch(d){c=!0,i=d}finally{try{r||null==l.return||l.return()}finally{if(c)throw i}}u([].concat(e,a)),m(a)}}),[t]),r.a.createElement(W,{onSubmit:function(e,t){j(!0),h.a.updateClient(n,{locations:t.map((function(e){return e.id}))}).then(c).then((function(){j(!1),i&&i()}))},loading:O,items:s,right:p,onChange:function(e){return m(e)},comparator:function(e,t){return e.id===t.id},listMapper:function(e){return{id:e.id,primaryLabel:e.name,secondaryLabel:e.address}}})})),K=n(23),Q=n(100),X=Object(c.b)((function(e){return{users:e.users}}))((function(e){var t=e.users,n=e.clientId,c=e.onSubmit,i=Object(a.useState)([]),o=Object(S.a)(i,2),l=o[0],s=o[1],u=Object(a.useState)([]),d=Object(S.a)(u,2),f=d[0],p=d[1],m=Object(a.useState)(!1),b=Object(S.a)(m,2),g=b[0],O=b[1];return Object(a.useEffect)((function(){if(t&&t.data){var e=[],a=[],r=!0,c=!1,i=void 0;try{for(var o,l=t.data[Symbol.iterator]();!(r=(o=l.next()).done);r=!0){var u=o.value;n===u.clientId?a.push(u):null===u.clientId&&u.role!==K.Role.MASTER&&e.push(u)}}catch(d){c=!0,i=d}finally{try{r||null==l.return||l.return()}finally{if(c)throw i}}console.log(e,a),s([].concat(e,a)),p(a)}}),[t]),r.a.createElement(W,{onSubmit:function(e,t){O(!0),h.a.updateClient(n,{users:t.map((function(e){return e.id}))}).then((function(){O(!1),c&&c()}))},loading:g,items:l,right:f,onChange:function(e){return p(e)},comparator:function(e,t){return e.id===t.id&&e.clientId===t.clientId},listMapper:function(e){return{id:e.id,primaryLabel:"".concat(e.firstName," ").concat(e.lastName),secondaryLabel:"".concat(e.username," ").concat(Object(Q.k)(e.role))}}})})),Y=Object(c.b)((function(e){return{vehicles:e.vehicles}}))((function(e){var t=e.vehicles,n=e.clientId,c=e.onSubmit,i=Object(a.useState)([]),o=Object(S.a)(i,2),l=o[0],s=o[1],u=Object(a.useState)([]),d=Object(S.a)(u,2),f=d[0],p=d[1],m=Object(a.useState)(!1),b=Object(S.a)(m,2),g=b[0],O=b[1];return Object(a.useEffect)((function(){if(t&&t.data){var e=[],a=[],r=!0,c=!1,i=void 0;try{for(var o,l=t.data[Symbol.iterator]();!(r=(o=l.next()).done);r=!0){var u=o.value;n===u.clientId?a.push(u):null===u.clientId&&e.push(u)}}catch(d){c=!0,i=d}finally{try{r||null==l.return||l.return()}finally{if(c)throw i}}s([].concat(e,a)),p(a)}}),[t]),r.a.createElement(W,{onSubmit:function(e,t){O(!0),h.a.updateClient(n,{vehicles:t.map((function(e){return e.id}))}).then((function(){O(!1),c&&c()}))},loading:g,items:l,right:f,onChange:function(e){return p(e)},comparator:function(e,t){return e.id===t.id&&e.clientId===t.clientId},listMapper:function(e){return{id:e.id,primaryLabel:e.plateNumber,secondaryLabel:"".concat(e.brand," ").concat(e.model)}}})})),Z=n(428),$=n(423),_=n(437),ee=n(438),te=n(435),ne=n(422),ae=n(450),re=n(440),ce=n(441),ie=n(446),oe=n(434),le=n(427),se=n(429),ue=n(449),de=n(453),fe=n(419),pe=n(321),he=n(319),me=n(447),be={Add:Object(a.forwardRef)((function(e,t){return r.a.createElement(Z.a,Object.assign({},e,{ref:t}))})),Check:Object(a.forwardRef)((function(e,t){return r.a.createElement($.a,Object.assign({},e,{ref:t}))})),Clear:Object(a.forwardRef)((function(e,t){return r.a.createElement(_.a,Object.assign({},e,{ref:t}))})),Delete:Object(a.forwardRef)((function(e,t){return r.a.createElement(ee.a,Object.assign({},e,{ref:t}))})),DetailPanel:Object(a.forwardRef)((function(e,t){return r.a.createElement(te.a,Object.assign({},e,{ref:t}))})),Edit:Object(a.forwardRef)((function(e,t){return r.a.createElement(ne.a,Object.assign({},e,{ref:t}))})),Export:Object(a.forwardRef)((function(e,t){return r.a.createElement(ae.a,Object.assign({},e,{ref:t}))})),Filter:Object(a.forwardRef)((function(e,t){return r.a.createElement(re.a,Object.assign({},e,{ref:t}))})),FirstPage:Object(a.forwardRef)((function(e,t){return r.a.createElement(ce.a,Object.assign({},e,{ref:t}))})),LastPage:Object(a.forwardRef)((function(e,t){return r.a.createElement(ie.a,Object.assign({},e,{ref:t}))})),NextPage:Object(a.forwardRef)((function(e,t){return r.a.createElement(te.a,Object.assign({},e,{ref:t}))})),PreviousPage:Object(a.forwardRef)((function(e,t){return r.a.createElement(oe.a,Object.assign({},e,{ref:t}))})),ResetSearch:Object(a.forwardRef)((function(e,t){return r.a.createElement(_.a,Object.assign({},e,{ref:t}))})),Search:Object(a.forwardRef)((function(e,t){return r.a.createElement(le.a,Object.assign({},e,{ref:t}))})),SortArrow:Object(a.forwardRef)((function(e,t){return r.a.createElement(se.a,Object.assign({},e,{ref:t}))})),ThirdStateCheck:Object(a.forwardRef)((function(e,t){return r.a.createElement(ue.a,Object.assign({},e,{ref:t}))})),ViewColumn:Object(a.forwardRef)((function(e,t){return r.a.createElement(de.a,Object.assign({},e,{ref:t}))}))},ge=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(s.a)(this,Object(u.a)(t).call(this,e))).componentDidMount=function(){n.reduceCategoryData()},n.componentDidUpdate=function(e){n.props.clients!==e.clients&&n.reduceCategoryData()},n.reduceCategoryData=function(){var e=n.props.clients;e&&e.data&&n.setState({clientData:e.data})},n.state={clientColumns:[{title:"ID",type:"numeric",field:"id",editable:"onUpdate"},{title:"Name",field:"name"}],clientData:[],clientSelected:null},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.clients,a=t.fetchClients,c=t.location,i=t.history,o=this.state,l=o.clientColumns,s=o.clientData,u=function(e){return r.a.createElement(k,{title:e.title,open:!0,onClose:function(){return i.replace("/clients")},content:e.content})};return r.a.createElement(r.a.Fragment,null,r.a.createElement(m,{location:c,history:i,routes:[{path:"/clients/users/edit",render:function(){return u({title:"Add users to client",content:e.state.clientSelected&&r.a.createElement(X,{clientId:e.state.clientSelected.id,onSubmit:function(){e.props.fetchUsers(),e.props.history.replace("/clients")}})||r.a.createElement(f.a,{to:"/clients"})})}},{path:"/clients/vehicles/edit",render:function(){return u({title:"Add vehicles to client",content:e.state.clientSelected&&r.a.createElement(Y,{clientId:e.state.clientSelected.id,onSubmit:function(){e.props.fetchVehicles(),e.props.history.replace("/clients")}})||r.a.createElement(f.a,{to:"/clients"})})}},{path:"/clients/locations/edit",render:function(){return u({title:"Add locations to client",content:e.state.clientSelected&&r.a.createElement(G,{clientId:e.state.clientSelected.id,onSubmit:function(){e.props.fetchLocations(),e.props.history.replace("/clients")}})||r.a.createElement(f.a,{to:"/clients"})})}}]}),r.a.createElement(g.a,{editable:{onRowUpdate:function(e){var t=e.id,n=e.name;return new Promise((function(e){h.a.updateClient(t,{name:n}).then(a).then((function(){return e()}))}))},onRowAdd:function(e){var t=e.name;return new Promise((function(e){h.a.createClient({name:t}).then(a).then((function(){return e()}))}))}},isLoading:null===n,title:"Clients",columns:l,data:s,icons:be,actions:[{icon:function(){return r.a.createElement(fe.a,null)},tooltip:"Refresh",isFreeAction:!0,onClick:function(t,n){return Promise.all([e.props.fetchClients(),e.props.fetchUsers(),e.props.fetchVehicles(),e.props.fetchLocations()])}},{icon:function(){return r.a.createElement(pe.a,null)},tooltip:"Add vehicles",onClick:function(t,n){e.setState({clientSelected:n}),i.replace("/clients/vehicles/edit",{modal:!0})}},{icon:function(){return r.a.createElement(he.a,null)},tooltip:"Add Locations",onClick:function(t,n){e.setState({clientSelected:n}),i.replace("/clients/locations/edit",{modal:!0})}},{icon:function(){return r.a.createElement(me.a,null)},tooltip:"Add Users",onClick:function(t,n){e.setState({clientSelected:n}),i.replace("/clients/users/edit",{modal:!0})}}]}))}}]),t}(a.Component),Oe=Object(p.a)(f.h,Object(c.b)((function(e){return{clients:e.clients}}),i))(ge);t.default=Object(c.b)(null,i)((function(e){var t=e.fetchClients,n=e.fetchLocations,c=e.fetchUsers,i=e.fetchVehicles;e.location,e.history;return Object(a.useEffect)((function(){t(),n(),c(),i()}),[]),r.a.createElement(Oe,null)}))}}]);
//# sourceMappingURL=15.9b075182.chunk.js.map